function removeTemplateData(){$("#fileUploadTemplate").hide();$("#fileUploadTemplateInput").val(null)}function removeDataSourceData(){$("#fileUploadDataSource").hide();$("#fileUploadDataSourceInput").val(null);$("#TableIndex").hide();$("#TableDelimiter").hide()}function setDelimiter(n,t=null){delimiter=n;t===null&&(t=delimiter);$("#delimiter")[0].innerText=t}var stage=0,delimiter=",";$(document).ready(function(){function p(){e(stage+1)}function w(){e(stage-1)}function b(){e(0);removeDataSourceData();removeTemplateData();n.val(null);t.val(null)}function e(n,t=true){var i=$("#StageContent");t?i.fadeOut(300,function(){y(n);i.fadeIn()}):y(n)}function y(n){stage=n;switch(n){case 0:s.text("STAGE 1/3");h.show();c.show();l.hide();a.hide();v.hide();i.show();r.hide();u.hide();f.hide();break;case 1:s.text("STAGE 2/3");h.hide();c.hide();l.show();a.show();v.show();i.show();r.show();u.hide();f.hide();break;case 2:s.text("STAGE 3/3");h.hide();c.hide();l.hide();a.hide();v.hide();i.hide();r.show();u.show();f.show()}}var s=$("#StageLabel"),h=$("#TemplateHelpButton"),c=$("#TemplateFileDrop"),l=$("#DataSourceHelpButton"),a=$("#DataSourceFileDrop"),v=$("#DataSourceForms"),i=$("#NextButton"),r=$("#BackButton"),u=$("#AnotherFileButton"),f=$("#AssembleButton"),n=$("#TableIndex"),t=$("#TableDelimiter");n.hide();t.hide();$("#fileUploadTemplate").hide();$("#fileUploadTemplateInput").change(function(){var n=$("#fileUploadTemplateInput")[0].files[0].name;$("#fileUploadTemplate label").text(n);$("#fileUploadTemplate").show()});$("#fileUploadDataSource").hide();$("#fileUploadDataSourceInput").change(function(){var i=$("#fileUploadDataSourceInput")[0].files[0].name,r=/(?:\.([^.]+))?$/.exec(i)[1].toLowerCase();switch(r){case"xml":case"json":n.hide();t.hide();break;case"csv":n.hide();t.show();break;default:n.show();t.hide()}$("#fileUploadDataSource label").text(i);$("#fileUploadDataSource").show()});i.click(function(n){n.preventDefault();p()});r.click(function(n){n.preventDefault();w()});u.click(function(n){n.preventDefault();b()});e(0,!1);f.click(function(n){n.preventDefault();let r=$("#fileUploadTemplateInput")[0].files;if(r.length===0){showAlert(o.FileSelectMessage);return}let u=$("#fileUploadDataSourceInput")[0].files;if(u.length===0){showAlert(o.FileSelectMessage);return}let t=new FormData,f=r[0],e=u[0];t.append("template",f,f.name);t.append("dataSource",e,e.name);var s=$("#DataSourceName").val(),i=$("#datasourceTableIndex").val();i===""&&(i=0);let h=o.APIBasePath+"AsposeEmailAssembly/Assemble?delimiter="+delimiter+"&sourceName="+s+"&tableIndex="+i;request(h,t)})});